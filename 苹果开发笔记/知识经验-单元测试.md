

理论知识


测试按阶段划分为：单元测试、集成测试、系统测试、回归测试
单元测试：测试对象是软件设计的最小单位-模块，是一种白盒测试
白盒测试：一种细粒度的测试，具体到方法、函数和异常测试。
测试驱动开发：设计单元测试用例→编写单元测试程序→程序编码→单元测试→出具单元测试报告
测试用例：一组条件和场景，根据它来确定程序的正确性
断言：编写代码时，我们总是会做出一些假设，断言就是用于在代码中捕捉这些假设。

应用测试：是对整个应用程序进行的测试；创建工程时会自动创建；可以在模拟器或真机上运行；加载时间长，需要加载整个应用；没有scheme
逻辑测试：轻量级的，只测试某个业务逻辑对象的方法或算法的正确性；通过Target创建；只能在模拟器上运行；加载时间短，只需加载被测试类；会生成一个scheme

基于测试驱动的单元测试是迭代式的
如果使用测试框架进行测试，以test开头是必须的，框架根据这个条件判断哪些是测试方法，哪些是普通方法


************************************************************************************************************************************************
************************************************************************************************************************************************


手动创建测试程序


1、设计单元测试用例
	制定一组模拟数据
2、编写单元测试程序
	2.1、把程序的大致模型建立好，具体方法的实现可以先不写
	2.2、创建测试用target-xxxTest
			2.2.1、选择空程序，删除AppDegelate类
			2.2.2、创建Test类，导入要测试的类.h，书写初始化资源、释放资源、测试方法（模拟输入假数据，输出判断信息）
			2.2.3、修改target的main.m，把AppDegelate的有关代码去掉；初始化Test类对象，调用相关方法
			2.2.3、要测试的类.m—文件检查器—Target Membership—target打勾
3、选择测试用target进行测试、出具测试报告


************************************************************************************************************************************************
************************************************************************************************************************************************

XCTest

xcode5后自带
可进行逻辑测试及应用测试

应用单元测试：创建项目时默认同时创建
逻辑单元测试：新建target—单元测试bundle

Membership无需把被测试类关联测试类


************************************************************************************************************************************************
************************************************************************************************************************************************

GHUnit

第三方框架
只能做逻辑测试

使用步骤：
target—空项目
到https://github.com/gh-unit/gh-unit/downloads下载框架，导入到target，还要导入QuartzCore框架
Other Linker Flags添加-Objc、-all_load；确保Framework Search Paths中已包含了GHUnitIOS.framework所在的路径
删除target中的AppDelegate类，修改main.m中的AppDelegate对象为@"GHUnitIOSAppDelegate"
被测试类的.m文件—文件检查器—Membership—target打勾（使他能够编译到所有的target中）


注：setUpClass/tearDownClass方法在整个测试生命周期只调用1次


************************************************************************************************************************************************
************************************************************************************************************************************************

伪对象

OCMock

提供伪对象

流程：创建伪对象—设置伪对象状态-设置伪对象中的期望值—将伪对象作为参数调用逻辑方法—验证伪对象的一致性

使用步骤：
到http://ocmock.ory下载OCMock文件，把里面的给ios用的文件拖入工程
把静态库添加到工程中逻辑测试的target中，设置静态库的Membership关联到逻辑测试的target
header seaarch paths—添加${PROJECT_DIR}/OCMockiOS—选择recursive
创建测试类继承于XCTest—设置伪对象的状态和期望值—验证伪对象的一致性

************************************************************************************************************************************************
************************************************************************************************************************************************

分层设计中的单元测试

严格上来说每个方法需要有多个测试用例，可以把粒度放大到一个方法只有一个测试用例


表示层
逻辑测试—XCTest
业务逻辑层层的静态库Membership关联到target，而数据持久层的静态库不用，因为使用业务逻辑层的静态库时会把数据持久层的静态库一起复制到编译环境
伪对象：导入OCMock—修改User Header Search Paths修改为$(BUILT_PRODUCTS_DIR)
应用测试—只用伪对象（注：要把逻辑测试target升级为应用测试target（修改编译参数Bundle loader、Test Host））



业务逻辑层—XCTest
只做逻辑测试
例如业务逻辑层依赖数据持久层，则需要设置User Header Search Paths（用于指定用户提供类库的头文件的搜索路径）和Library Search Paths（用于设定类库搜索路径），如下：
User Header Search Paths修改为$(BUILT_PRODUCTS_DIR)
Library Search Paths清除原来的内容



数据持久层—XCTest
只做逻辑测试
实体类只有一些属性，这种类不需要进行测试
如果方法之间有依赖关系，测试方法的顺序也很重要
