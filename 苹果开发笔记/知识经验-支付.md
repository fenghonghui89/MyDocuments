
# 支付宝

- 客服 https://cschannel.alipay.com/portal.htm?sourceId=213
- 跳转用的urlscheme不能带下划线


# paypal

- 历史
```
braintree 收购venmo，paypal收购braintree
braintree sdk 与 paypal sdk 支持国家不同，braintree 支持hk不支持大陆
```
- braintree
```
v4版本接入
详细查看braintree ios sdk的github接入文档，要点是把sdk包里面的braintree.xcodeproj放入项目里面做子项目，embeded library要添加库
```
- paypal插件
```
要额外设置invoiceNumber，并且PayPalMobileCordovaPlugin.m->payPalPaymentViewController:didCompletePayment:回调里面要修改如下，因为默认传回去网页的是不带invoiceNumber：
NSMutableDictionary *dic = [NSMutableDictionary dictionaryWithDictionary:completedPayment.confirmation];
[dic setObject:completedPayment.invoiceNumber forKey:@"invoiceNumber.."];
 CDVPluginResult *pluginResult = [CDVPluginResult resultWithStatus:CDVCommandStatus_OK messageAsDictionary:dic];
```

# 杂

- 友盟微信分享与微信支付冲突问题

微信分享与微信支付的appid要一致

- 支付宝与微信支付兼容

```
-(BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary<NSString *,id> *)options{
  
  BOOL result = [[DGCShareManager shareInstance] handleOpenURL:url];
  if (result == FALSE) {
    //如果极简 SDK 不可用,会跳转支付宝钱包进行支付,需要将支付宝钱包的支付结果回传给 SDK
    if ([url.host isEqualToString:@"safepay"]) {
      [[AlipaySDK defaultService] processOrderWithPaymentResult:url
                                                standbyCallback:^(NSDictionary *resultDic) {
                                                  NSLog(@"result = %@",resultDic);
                                                }];
    }
    
    if ([url.host isEqualToString:@"platformapi"]) {
      //支付宝钱包快登授权返回 authCode
      [[AlipaySDK defaultService] processAuthResult:url standbyCallback:^(NSDictionary *resultDic) {
        NSLog(@"result = %@", resultDic);
      }];
    }
  }
  
  
  
  //调用其他SDK，例如新浪微博SDK等
  [WXApi handleOpenURL:url delegate:[NKCThirdSDKPackage shareInstance]];
  
  return result;

}

```
